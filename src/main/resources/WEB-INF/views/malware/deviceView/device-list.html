<!-- ECharts单文件引入 -->
<script src="static/js/jquery.tools.min.js"></script>

<link rel="stylesheet" href="static/css/styles.css" type="text/css"/>
<link rel="stylesheet" href="static/css/jquery-tool.css" type="text/css"/>
<script src="static/js/logreport/logreport.js"></script>
<style>
    tr {
        color: #c0c0c0;
    }
    #expmenu-freebie .header{
        width: 100vh;
    }
    #expmenu-freebie .table{
        width: 97vh;
        table-layout: fixed;
    }
</style>
<div id="content">
    <ul id="expmenu-freebie">
        <li>
            <ul class="expmenu">
                @if(!isEmpty(flag)){
                <li>
                    <div class="header">
                        <span class="label" style="background-image: url(${ctxPath}/static/img/logreport/messages.png);">CPU</span>
                        <span class="arrow up"></span>
                    </div>
                    <ul class="menu">

                        <table class="table">
                            <tr>
                                <td colspan="2" style="text-align: center;"><strong
                                        style="font-size: 25px">CPU信息</strong></td>
                            </tr>
                            <tr>
                                <td style="width:50%;">CPU个数</td>
                                <td style="width:50%;">${softDevice.cpuNumber}</td>
                            </tr>
                            <tr>
                                <td>CPU内核数</td>
                                <td>${softDevice.cpuKernelNumber}</td>
                            </tr>
                            <tr>
                                <!-- 60-79橙色    80-100红色  -->
                                <td>
                                    CPU使用百分比
                                </td>
                                <td @if(!isEmpty(softDevice.cpuUsagePercentage)){
                                        @if(softDevice.cpuUsagePercentage>=60 && softDevice.cpuUsagePercentage<=79){
                                            style="color:orange"
                                        @}else if(softDevice.cpuUsagePercentage>=80 && softDevice.cpuUsagePercentage<=100){
                                            style="color:red"
                                        @ }
                                    @ }
                                >${softDevice.cpuUsagePercentage}%
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <!-- cpu使用情况发布图 -->
                                    <div id="cpuqlfb" style="height:250px;"></div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <!-- cpu使用情况趋势图-->
                                    <div id="cpuqlqs" style="height:250px;"></div>
                                </td>
                            </tr>
                        </table>
                    </ul>
                </li>

                @}
                @if(!isEmpty(flag)){
                <li>
                    <div class="header">
                        <span class="label" style="background-image: url(${ctxPath}/static/img/logreport/user.png);">内存</span>
                        <span class="arrow up"></span>
                    </div>
                    <ul class="menu">

                        <table class="table">
                            <tr>
                                <td colspan="4" style="text-align: center;"><strong
                                        style="font-size: 25px">内存信息</strong></td>
                            </tr>
                            <tr>
                                <td colspan="2" style="width:50%;">内存总大小</td>
                                <td colspan="2" style="width:50%;">${softDevice.totalMemorySize}G</td>
                            </tr>
                            <tr>
                                <!-- 60-79橙色    80-100红色  -->
                                <td colspan="2"
                                >已使用内存大小
                                </td>
                                <td colspan="2"
                                    @if(!isEmpty(softDevice.useMemorySize)){
                                        @if(softDevice.useMemorySize/softDevice.totalMemorySize>=0.6 && softDevice.useMemorySize/softDevice.totalMemorySize<=0.79){
                                            style="color:orange"
                                        @}else if(softDevice.useMemorySize/softDevice.totalMemorySize>0.79 && softDevice.useMemorySize/softDevice.totalMemorySize<=1){
                                            style="color:red"
                                        @ }
                                    @ }
                                >${softDevice.useMemorySize}G</td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    <!-- 内存使用情况发布图 -->
                                    <div id="ncqlfb" style="height:250px;"></div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    <!-- 内存使用情况趋势图-->
                                    <div id="ncqlqs" style="height:250px;"></div>
                                </td>
                            </tr>
                        </table>
                    </ul>
                </li>
                @}
                @if(!isEmpty(flag)){
                <li>
                    <div class="header">
                        <span class="label" style="background-image: url(${ctxPath}/static/img/logreport/pc.png);">磁盘</span>
                        <span class="arrow up"></span>
                    </div>
                    <ul class="menu">

                        <table class="table">
                            <tr>
                                <td colspan="4" style="text-align: center;"><strong
                                        style="font-size: 25px;">硬盘信息</strong></td>
                            </tr>
                            @for(item in softHardDiskList){
                            <tr>
                                <td>硬盘路径</td>
                                <td>${item.hardPath!}</td>
                                <td>硬盘总大小</td>
                                <td>${item.hardSize!}G</td>
                            </tr>
                            @}
                            <tr>
                                <td colspan="4">
                                    <!--硬盘使用情况发布图 -->
                                    <div id="ypqlfb" style="height:250px;"></div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    <!-- 硬盘使用情况趋势图-->
                                    <div id="ypqlqs" style="height:250px;"></div>
                                </td>
                            </tr>
                        </table>


                    </ul>
                </li>
                @}
                @if(!isEmpty(flag)){
                <li>
                    <div class="header">
                        <span class="label" style="background-image: url(${ctxPath}/static/img/logreport/search.png);">网络</span>
                        <!-- down 图标向下显示 ，up向上显示
                        <span class="arrow down"></span>
                         -->
                        <span class="arrow up"></span>
                    </div>
                    <ul class="menu" style="display:block">

                        <table class="table">
                            <tr>
                                <td colspan="2" style="text-align: center;"><strong
                                        style="font-size: 25px">系统进程信息</strong></td>
                            </tr>
                            @for(item in processList){
                            <tr>
                                <td style="width:50%;">${item.processName}</td>
                                <td style="width:50%;">${item.processState}</td>
                            </tr>
                            @}
                            <tr>
                                <td colspan="2" style="text-align: center;"><strong
                                        style="font-size: 25px;">故障信息</strong></td>
                            </tr>
                            <tr>
                                <td style="width:50%;">故障名称</td>
                                <td style="width:50%;">结果</td>
                            </tr>
                            @for(item in faultList){
                            <tr>
                                <td>${item.faultName}</td>
                                <td>${item.faultResult}</td>
                            </tr>
                            @}
                        </table>
                    </ul>
                </li>
                @}
            </ul>
        </li>
    </ul>
</div>


<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    //cpu使用情况发布图
    var cpufbChart = echarts.init(document.getElementById('cpuqlfb'));
    //cpu使用情况趋势图
    var cpuqsChart = echarts.init(document.getElementById('cpuqlqs'));

    //内存使用情况发布图
    var ncfbChart = echarts.init(document.getElementById('ncqlfb'));
    //内存使用情况趋势图
    var ncqsChart = echarts.init(document.getElementById('ncqlqs'));
    //硬盘使用情况发布图
    var ypfbChart = echarts.init(document.getElementById('ypqlfb'));
    //硬盘使用情况趋势图
    var ypqsChart = echarts.init(document.getElementById('ypqlqs'));


    var data = [];//内存数据
    var time = []; //时间戳
    var ypdata = [];//硬盘数据
    var cpudata = [];//cpu数据
    var nclist = ${historyList};
    for (var i = 0; i < nclist.length; i++) {
        var memoryUsage = nclist[i].memoryUsage;
        data.push(memoryUsage);
        var monitoringTime = nclist[i].monitoringTime;


        var date = new Date(monitoringTime);
        Y = date.getFullYear() + '-';
        M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
        D = date.getDate() + ' ';
        h = date.getHours() + ':';
        m = date.getMinutes() + ':';
        s = date.getSeconds();


        time.push(Y + M + D + h + m + s);
        var hardDiskUsage = nclist[i].hardDiskUsage;
        ypdata.push(hardDiskUsage);
        var cpuUsage = nclist[i].cpuUsage;
        cpudata.push(cpuUsage);
    }

    //cpu使用情况发布图
    var option = {
        title: {
            text: 'CPU使用情况分布图',
            subtext: '',
            x: 'center',
            textStyle: {
                color: "#c0c0c0"
            }
        },
        color: ['#a1cfd3', '#76d379'],
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            left: '25%',
            top: '20%',
            data: ['使用', '\n', '空闲'],
            textStyle: {
                color: "#c0c0c0"
            }
        },
        series: [
            {
                name: 'CPU使用情况',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [

                    {value: ${softDevice.cpuUsedSize!}, name: '使用'},
                    {value: ${softDevice.cpuTotalSize!}-${softDevice.cpuUsedSize!}, name: '空闲'}
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };

    cpufbChart.setOption(option);

    //cpu使用情况趋势图
    option = {
        title: {
            text: 'CPU使用情况趋势图',
            x: 'center',
            textStyle: {
                color: '#c0c0c0'
            }
        },
        color: ['#1fc006'],
        tooltip: {
            trigger: 'axis',

        },
        xAxis: {
            type: 'category',
            splitLine: {
                show: true
            },
            data: time,
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            }
        },
        yAxis: {
            type: 'value',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: true
            },
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            }
        },
        series: [{
            name: 'CPU使用率(单位:%)',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            textStyle: {
                color: '#c0c0c0'
            },
            data: cpudata
        }]
    };

    cpuqsChart.setOption(option);

    //内存使用情况分布图
    var option = {
        title: {
            text: '内存使用情况分布图',
            subtext: '',
            x: 'center',
            textStyle: {
                color: '#c0c0c0'
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        color: ['#a1cfd3', '#76d379'],
        legend: {
            x: '25%',
            y: '20%',
            data: ['使用', '', '空闲'],
            textStyle: {
                color: '#c0c0c0'
            }
        },
        series: [
            {
                name: '内存分布',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value:${softDevice.useMemorySize!}, name: '使用'},
                    {value:${softDevice.totalMemorySize!}-${softDevice.useMemorySize!}, name: '空闲'}
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };
    ncfbChart.setOption(option);


    //内存使用情况趋势图
    var optionqs = {
        title: {
            text: '内存使用情况趋势图',
            x: 'center',
            textStyle: {
                color: '#c0c0c0'
            }
        },
        color: ['#1fc006'],
        tooltip: {
            trigger: 'axis',

        },
        xAxis: {
            type: 'category',
            splitLine: {
                show: true
            },
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            },
            data: time
        },
        yAxis: {
            type: 'value',
            boundaryGap: [0, '100%'],
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            },
            splitLine: {
                show: true
            }
        },
        series: [{
            name: '内存使用率(单位:%)',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            data: data
        }]
    };

    ncqsChart.setOption(optionqs);

    //硬盘使用情况分布图
    var totalHardUsed = 0;//汇总已使用大小
    var totalhardSize = 0; //总使用大小
    var nclist = ${softHardDiskList};
    for (var i = 0; i < nclist.length; i++) {
        var hardUsed = nclist[i].hardUsed; //已使用大小
        var hardSize = nclist[i].hardSize;//硬盘总大小
        totalHardUsed += hardUsed;
        totalhardSize += hardSize;
    }
    var totalfreeHard = totalhardSize - totalHardUsed;

    var option = {
        title: {
            text: '硬盘使用情况分布图',
            subtext: '',
            x: 'center',
            textStyle: {
                color: '#c0c0c0'
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        color: ['#a1cfd3', '#76d379'],
        legend: {
            x: '25%',
            y: '20%',
            data: ['使用','\n', '空闲'],
            textStyle: {
                color: '#c0c0c0'
            }
        },
        series: [
            {
                name: '硬盘大小',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value: totalHardUsed, name: '使用'},
                    {value: totalfreeHard, name: '空闲'}
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };

    ypfbChart.setOption(option);


    //硬盘使用情况趋势图
    option = {
        title: {
            text: '硬盘使用情况趋势图',
            x: 'center',
            textStyle: {
                color: 'c0c0c0'
            }
        },
        color: ['#1fc006'],
        tooltip: {
            trigger: 'axis',
        },
        xAxis: {
            type: 'category',
            splitLine: {
                show: true
            },
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            },
            data: time
        },
        yAxis: {
            type: 'value',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: true
            },
            axisLabel : {
                textStyle : {
                    color : '#c0c0c0'
                }
            }
        },
        series: [{
            name: '硬盘使用率(单位:%)',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            data: ypdata
        }]
    };

    ypqsChart.setOption(option);

</script>


<div class="space-8"></div>