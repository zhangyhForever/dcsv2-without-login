<div class="tab-content">
    <div id="home" class="tab-pane active">
        <#searchStrategy>
        <form action="${ctxPath}/apkUrlTable/findApkList" method="post" id="search-form-apk"
              target="list-page-apk" class="center">
            <div class="row">
                <div class="col-sm-4">
                    <label class="inline col-sm-6">开始时间：</label>
                    <input type="text" class="width-50 Wdate" id="beginTime"name="beginTime"
                           onClick="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'%y-%M-{%d}'})"/>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">结束时间：</label>
                    <input type="text" class="width-50 Wdate" name="endTime"
                           onclick="WdatePicker({dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'beginTime\')}'})"/>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">病毒名称：</label>
                    <input type="text" class="width-50" name="virusName"/>
                </div>
            </div>
            <div class="row padding-tb-10">
                <div class="col-sm-4">
                    <label class="inline col-sm-6">文件MD5：</label>
                    <input type="text" class="width-50" name="md5"/>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">IP：</label>
                    <input type="text" class="width-50" name="serverip"/>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">URL：</label>
                    <input type="text" class="width-50" name="url"/>
                </div>
            </div>
            <div class="row ">
                <div class="col-sm-4">
                    <label class="inline col-sm-6">归属国家：</label>
                    <select id="country" name="country" class="width-50" onchange="goProvince(this.value)">
                        <option value="">全部</option>
                        @for(item in countries){
                        <option value="${item}">${item}</option>
                        @}
                    </select>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">归属省：</label>
                    <select id="province" name="province" class="width-50" onchange="gocity(this.value)">
                        <option value="">全部</option>
                        @for(item in provinces){
                        <option value="${item}">${item}</option>
                        @}
                    </select>
                </div>
                <div class="col-sm-4">
                    <label class="inline col-sm-6">归属市：</label>
                    <select id="city" name="city" class="width-50">
                        <option value="">全部</option>
                        @for(item in cities){
                        <option value="${item}">${item}</option>
                        @}
                    </select>
                </div>
            </div>
            <div class="row padding-tb-10">
                <div class="col-sm-4">
                    <label class="inline col-sm-6">归属运营商：</label>
                    <select id="carrier" name="carrier" class="width-50">
                        <option value="">全部</option>
                        @for(item in carriers){
                        <option value="${item.carrier!}">${item.carrier!}</option>
                        @}
                    </select>
                </div>
            </div>
            <div class="row padding-tb-10">
                <div class="col-sm-8">
				<span
                        class="btn btn-info btn-sm col-sm-3" id="search-btn-apk">条 件 查 询</span>
                    <span class="btn center btn-primary btn-sm col-sm-3"
                          onclick="reForm('search-form-apk','search-btn-apk')">重 置</span>
                </div>
            </div>
        </form>
    </#searchStrategy>
    <div class="space-6"></div>

    <input id="hid" value="${hid}" style="display:none;">
    <button class="btn btn-default btn-sm btn-info" data-title="添加"
            data-height="80%" data-width="50%" id="add_urlTable" onclick="addUrlTable();">添加</button>
    <button  class="btn btn-default btn-sm btn-info" onclick = "selectIds('update');"  data-title="编辑"
             data-url="${ctxPath}/apkUrlTable/update/showDetail"
             data-height="80%" data-width="40%" id="updateId">修改</button>
    <button  class="btn btn-default btn-sm btn-info" onclick = "selectIds('del');"  data-title="删除操作"    data-msg="你确定删除此数据吗?"
             data-url="${ctxPath}/apkUrlTable/delete"
             data-height="80%" data-width="40%" id="deleteId">删除</button>
    <button type="button" class="btn btn-default btn-sm btn-info" onclick="downmodel()">特征导入模板下载</button>
    <!-- <button type="button" class="btn btn-default btn-sm btn-info" onclick="exportlist()" >导出数据</button> -->
    <!-- <button type="button" class="btn btn-default btn-sm btn-info"  data-url="${ctxPath}/apkUrlTable/openExport">导出数据</button> -->
    <a class="btn btn-default btn-sm btn-info" id="export"
       data-mode="detail" data-title="导出"
       data-url="${ctxPath}/apkUrlTable/openExport"
       data-width='50%'
       data-height='50%'
    >导出数据
    </a>
    <button type="button" class="btn btn-default btn-sm btn-info" title="导入特征库" data-title="导入特征库数据" 	data-mode="page"
            data-url="${ctxPath}/apkUrlTable/uploadtzk" data-width="50%" data-height="50%" data-data="{flag:'apkdown'}">导入数据</button>
    <div style="border:1px solid #ffffff">
        <div id="list-page-apk"></div>
    </div>
</div>

<script type="text/javascript">

    $("#search-form-apk").getPageList({'submitBtnId':'search-btn-apk'});
    //弹出增加按钮
    function addUrlTable(){
        var id = $("#myidkey").val();
        if(id==""){id=1;};
        $("#add_urlTable").attr("data-data","{flag:'"+id+"'}");
        $("#add_urlTable").attr("data-url","${ctxPath}/apkUrlTable/addapk");
        $("#add_urlTable").attr("data-mode","detail");

    }

    //选择id
    function selectIds(bs){
        $("#deleteId").removeAttr("data-data");
        $("#deleteId").removeAttr("data-mode");
        $("#updateId").removeAttr("data-data");
        $("#updateId").removeAttr("data-mode");
        var check_val = [];
        $("input[name='onSelect']:checked").each(function(){
            check_val.push($(this).val());
        });
        if(check_val.length==0){
            layer.msg('<span class="red bigger-120">请选择需要操作的数据</span>');
            return;
        }
        if(check_val.length!=0){
            if(bs=='update'){
                if(check_val.length==1){
                    $("#updateId").attr("data-data","{id:'"+check_val+"'}");
                    $("#updateId").attr("data-mode","page");
                }else{
                    layer.msg('<span class="red bigger-120">修改每次只能操作一条数据</span>');
                    return;
                }
            }else{
                $("#deleteId").attr("data-data","{ids:'"+check_val+"'}");
                $("#deleteId").attr("data-mode","del");
            }

        }

    }
    //导出特征库
    function exportlist(){
        var check_val = [];
        $("input[name='onSelect']:checked").each(function(){
            check_val.push($(this).val());
        });
        window.open("${ctxPath}/apkUrlTable/export?flag=apkdown&ids="+check_val).focus();
    }


    //特征导入模板下载
    function downmodel(){
        window.open("${ctxPath}/apkUrlTable/blDownloadExcel?srcName=maliciousCode_data_template.xlsx&dscName=maliciousCode_data_template.xlsx").focus();
    }
</script>