<div class="tabbable">
    <ul class="nav nav-tabs" id="myTab">
        <li class="active" id="apk-btn">
            <a data-toggle="tab" href="#apk">
                <i class="green ace-icon fa fa-users bigger-120"></i> APK特征库
            </a>
        </li>

        <li class="" id="dy-btn">
            <a data-toggle="tab" href="#dy">
                <i class="green ace-icon fa fa-users bigger-120"></i> 钓鱼网站特征库
            </a>
        </li>
    </ul>
        <div class="tab-content">
            <!-- APK -->
            <div id="apk" class="tab-pane active clearfix">
                <#search>
                <form action="${ctxPath}/apkUrlTable/findApkList" method="post" id="search-form-apk"
                      target="list-page-apk" class="center clearfix">
                    <div class="row">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">开始时间：</label>
                            <input type="text" class="width-50 Wdate" name="beginTime"
                                   onClick="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'%y-%M-{%d}'})"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">结束时间：</label>
                            <input type="text" class="width-50 Wdate" name="endTime"
                                   onclick="WdatePicker({dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'beginTime\')}'})"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">病毒名称：</label>
                            <input type="text" class="width-50" name="virusName"/>
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">文件MD5：</label>
                            <input type="text" class="width-50" name="md5"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">IP：</label>
                            <input type="text" class="width-50" name="serverip"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">URL：</label>
                            <input type="text" class="width-50" name="url"/>
                        </div>
                    </div>
                    <div class="row ">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">归属国家：</label>
                            <select id="country" name="country" class="width-50" onchange="goProvince(this.value)">
                                <option value="">全部</option>
                                @for(item in countries){
                                <option value="${item}">${item}</option>
                                @}
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">归属省市：</label>
                            <select id="province" name="province" class="width-50" onchange="gocity(this.value)">
                                <option value="">全部</option>
                                @for(item in provinces){
                                <option value="${item}">${item}</option>
                                @}
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">归属地市：</label>
                            <select id="cityAPK" name="city" class="width-50">
                                <option value="">全部</option>
                                @for(item in citiesAPK){
                                <option value="${item}">${item}</option>
                                @}
                            </select>
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">归属运营商：</label>
                            <select id="carrier" name="carrier" class="width-50">
                                <option value="">全部</option>
                                @for(item in carriers){
                                <option value="${item.carrier!}">${item.carrier!}</option>
                                @}
                            </select>
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-8">
				<span
                        class="btn btn-info btn-sm col-sm-3" id="search-btn-apk">条 件 查 询</span>
                            <span class="btn center btn-primary btn-sm col-sm-3"
                                  onclick="reForm('search-form-apk','search-btn-apk')">重 置</span>
                        </div>
                    </div>
                </form>
            </#search>
            <div class="space-6"></div>
            <div style="border:1px solid #ffffff">
                <div id="list-page-apk"></div>
            </div>
        </div>
            <!-- 钓鱼 -->
            <search id="dy" class="tab-pane  clearfix">
                <#search>
                <form action="${ctxPath}/apkUrlTable/findDyList" method="post" id="search-form-dy"
                      target="list-page-dy" class="center">
                    <div class="row">

                        <div class="col-sm-4">
                            <label class="inline col-sm-6">开始时间：</label> <input type="text"
                                                                                class="width-50 Wdate" id="beginTime" name="beginTime" onClick="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'%y-%M-{%d}'})" />
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">结束时间：</label> <input type="text"
                                                                                class="width-50 Wdate" name="endTime" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'beginTime\')}'})"/>
                        </div>

                        <div class="col-sm-4">
                            <label class="inline col-sm-6">URL：</label> <input type="text"
                                                                               class="width-50" id="url" name="url" />
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">网站归属城市：</label>
                            <select class="width-50" id="cityDy" name="city" >
                                <option value="">--请选择--</option>
                                @for(var city in citiesDy){
                                    <option value="${city!}">${city!}</option>
                                @}
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">网站对应IP：</label> <input type="text"
                                                                                  class="width-50" id="ip" name="ip"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">域名注册商：</label> <input type="text"
                                                                                 class="width-50" id="registrars" name="registrars" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">危害等级：</label>
                            <select name="threatLevel" class=' width-50'>
                                <option value="">全部</option>
                                <option value="1">高</option>
                                <option value="2">中</option>
                                <option value="3">低</option>
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">发现来源：</label> <input type="text"
                                                                                class="width-50" name="sources"/>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">截图编号：</label> <input type="text"
                                                                                class="width-50" name="photoId" />
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">钓鱼网站类型：</label>
                            <select name="type" class=' width-50'>
                                <option value="">全部</option>
                                @for(var item in types){
                                <option value="${item.type!}">${item.type!}</option>
                                @}
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <label class="inline col-sm-6">仿冒对象：</label> <input type="text"
                                                                                class="width-50" id="fakeObject" name="fakeObject" />
                        </div>
                    </div>
                    <div class="row padding-tb-10">
                        <div class="col-sm-8">
                            <span
                                    class="btn btn-info btn-sm col-sm-3" id="search-btn-dy">条 件 查 询</span>
                            <span class="btn center btn-primary btn-sm col-sm-3"
                                  onclick="reForm('search-form-dy','search-btn-dy')">重 置</span>
                        </div>
                    </div>
                </form>
            </#search>
                <div class="space-6"></div>
                <div style="border:1px solid #ffffff; ">
                    <div id="list-page-dy"></div>
                </div>
    </div>
<!-- <button type="button" class="btn btn-default btn-sm btn-info">导出升级包</button> -->
</div>


<script type="text/javascript">

    $("#apk-btn").click(function () {
        $("#search-form-apk").getPageList({'submitBtnId':'search-btn-apk'});
        $("#search-form-dy").getPageList({'submitBtnId':'search-btn-dy'});
    })

    $("#dy-btn").click(function () {
        $("#search-form-dy").getPageList({'submitBtnId':'search-btn-dy'});
        $("#search-form-apk").getPageList({'submitBtnId':'search-btn-apk'});
    })

    $(function(){
        $("#apk-btn").click();
        //全选/全不选
        $("#all").click(function(){
            $("[name=onSelect]:checkbox").attr("checked",this.checked);
        });
        $("[name=onSelect]:checkbox").click(function(){
            var flag=true;
            $("[name=onSelect]:checkbox").each(function(){
                if(!this.checked){
                    flag=false;
                }
            });
            $("#all").attr("checked",flag);
        });
    }) ;
    //弹出增加按钮
    function addUrlTable(id){
        //var id = $("#myidkey").val();
        //if(id==""){id=1;};
        if(id === 1){
            $("#add_urlTable_apk").attr("data-data","{flag:'"+id+"'}");
            $("#add_urlTable_apk").attr("data-url","${ctxPath}/apkUrlTable/addapk");
            $("#add_urlTable_apk").attr("data-mode","detail");
        }else {
            $("#add_urlTable_dy").attr("data-data","{flag:'"+id+"'}");
            $("#add_urlTable_dy").attr("data-url","${ctxPath}/apkUrlTable/addapk");
            $("#add_urlTable_dy").attr("data-mode","detail");
        }

    }

    //选择id
    function selectIds(bs,id){

        $("#deleteId_apk").removeAttr("data-data");
        $("#deleteId_apk").removeAttr("data-mode");
        $("#updateId_apk").removeAttr("data-data");
        $("#updateId_apk").removeAttr("data-mode");
        $("#deleteId_dy").removeAttr("data-data");
        $("#deleteId_dy").removeAttr("data-mode");
        $("#updateId_dy").removeAttr("data-data");
        $("#updateId_dy").removeAttr("data-mode");

        var check_val = [];
        $("input[name='onSelect']:checked").each(function(){
            check_val.push($(this).val());
        });

        if(check_val.length==0){
            layer.msg('<span class="red bigger-120">请选择需要操作的数据</span>');
            return;
        }

        if(check_val.length!=0){
            if(bs=='update'){
                if(id === 1){
                    if(check_val.length==1){
                        $("#updateId_apk").attr("data-data","{id:'"+check_val+"'}");
                        $("#updateId_apk").attr("data-mode","page");
                    }else{
                        layer.msg('<span class="red bigger-120">修改每次只能操作一条数据</span>');
                        return;
                    }
                }else {
                    if(check_val.length==1){
                        $("#updateId_dy").attr("data-data","{id:'"+check_val+"'}");
                        $("#updateId_dy").attr("data-mode","page");
                    }else{
                        layer.msg('<span class="red bigger-120">修改每次只能操作一条数据</span>');
                        return;
                    }
                }
            }else{
                if(id === 1){
                    $("#deleteId_apk").attr("data-data","{ids:'"+check_val+"'}");
                    $("#deleteId_apk").attr("data-mode","del");
                }else {
                    $("#deleteId_dy").attr("data-data","{ids:'"+check_val+"'}");
                    $("#deleteId_dy").attr("data-mode","del");
                }
            }
        }
    }

    //导出特征库
    //导出特征库
    function exportlist(){
        $.ajax({
            url : "apkUrlTable/count",
            type: "POST",
            async: false ,
            dataType : 'json',
            success : function(data) {
                var check_val = [];
                $("input[name='onSelect']:checked").each(function(){
                    check_val.push($(this).val());
                });
// 				      alert(check_val.length);
                if(check_val.length==0&&data.data>=5000){
                    if(window.confirm('由于数据太多需要时间长，确定导出吗？')){
                        window.open("${ctxPath}/apkUrlTable/export?flag=down&ids="+check_val).focus();
                    }else{
                        return false;
                    }
                }else{
                    window.open("${ctxPath}/apkUrlTable/export?flag=down&ids="+check_val).focus();

                }
            }
        });
    }

    //特征导入模板下载
    function downmodel(data){
        if(data === "apk"){
            window.open("${ctxPath}/apkUrlTable/blDownloadExcel?srcName=maliciousCode_data_template.xlsx&dscName=maliciousCode_data_template.xlsx").focus();
        }else {
            window.open("${ctxPath}/apkUrlTable/blDownloadExcel?srcName=maliciousCodeGeneral_data_template.xlsx&dscName=maliciousCodeGeneral_data_template.xlsx").focus();
        }
    }

    //回调函数 刷新表格
    function callback() {
        $("#dy-btn").click();
    }

</script>