<div class="tabbable">
    <ul class="nav nav-tabs" id="myTab">
        <li class="active"><a data-toggle="tab" href="#phone" id="phoneManager"> <i
                class="green ace-icon fa fa-users bigger-120"></i> 恶意软件趋势分析
        </a></li>
    </ul>

    <div class="tab-content" style="height: 87vh; overflow: auto">
        <!--短信数量以及链接数量折线图  -->
        <div style="text-align:center;font-size:30px;color:#F00;margin-top:60px">
            @if(typeRate=="0"){
            近期无欺诈数据，请放心！
            @}else{
            近期${type}欺诈出现频率较高，占比${typeRate}%，请注意防范
            @}
        </div>
        <br>
        <br>
        <hr/>
        <br>
        <br>
        <div style="height:400px;">
            <div id="messagerefnum" style="height:400px;width:45%;margin-left:20px;float:left;"></div>
            <div id="netrefnum" style="height:400px;width:45%;margin-right:20px;float:right;"></div>

        </div>
        <hr/>
        <div class="" style="height:180px;width:40%;margin-left:50px;float:left;"> <!-- tab-content -->
            <div style="text-align:center;font-size:18px;color:white;font-weight:bold;margin-bottom:35px;">
                最近一周恶意短信检测记录
            </div>
            @if(isEmpty(netList)){
            <div style="text-align: center;font-size:20px;height: 80px;width:100%;color: #ff0000;" class="center">
                最近一周无短信检测记录
            </div>
            @}
            <marquee direction=down behavior="SCROLL" scrollAmount="2" bgcolor="" scrollamount="1"
                     style="height: 80px;width:100%;" onMouseOut="this.start()" onMouseOver="this.stop()">
                @for(item in mesList){
                <footer style="text-overflow:ellipsis; white-space:nowrap;overflow:hidden;"
                        title="${item.sendTelephone}:${item.body}">【${item.sendTelephone}】：${item.body}
                </footer>
                @}
            </marquee>
        </div>
        <div class="" style="height:180px;width:40%;margin-right: 50px;float:right;"> <!-- tab-content -->
            <div style="text-align:center;font-size:18px;color:white;font-weight:bold;margin-bottom:35px;">
                最近一周恶意网址访问记录
            </div>

            @if(isEmpty(netList)){
            <div style="text-align: center;font-size:20px;height: 80px;width:100%;color: red;" class="center">
                最近一周无网址访问记录
            </div>
            @}

            <marquee direction=down behavior="SCROLL" scrollAmount="2" bgcolor="" scrollamount="1"
                     style="height: 80px;width:100%;" onMouseOut="this.start()" onMouseOver="this.stop()">
                @for(item in netList){
                <footer style="text-overflow:ellipsis; white-space:nowrap;overflow:hidden;"
                        title="用户${item.netTelephone!}在${item.netFoundtime!,dateFormat='yyyy-MM-dd HH:mm:ss'}时间访问恶意链接为${item.netUrl!}">
                    用户：${item.netTelephone!} 在 ${item.netFoundtime!,dateFormat="yyyy-MM-dd HH:mm:ss"} 访问恶意链接：
                    ${item.netUrl!}
                </footer>
                @}
            </marquee>
        </div>
        <hr style="clear: both;"/>
        <div style="height:430px;margin-top:50px;">
            <div id="sourcebar" style="height:400px;width:45%;margin-left:20px;float:left;"></div>
            <div id="waybar" style="height:400px;width:45%;margin-right:20px;float:right;"></div>

        </div>
    </div>
</div>
<script type="text/javascript">
    var mesnum = [];
    var mesdate = [];
    var netnum = [];
    var netdate = [];
    $.ajax({
        url: "urltable/message",
        type: "POST",
        dataType: 'json',
        async: false,
        data: {},
        success: function (data) {
            mesnum = data.mesnum;
            mesdate = data.mesdate;
        }
    });
    var msrefnum = echarts.init(document.getElementById("messagerefnum"));
    var netrefnum = echarts.init(document.getElementById("netrefnum"));
    option_message = {
        title: {
            text: '一周内短信数据链接数量',
            x: 'center',
            textStyle:{
                color: '#FFF'
            }
        },
        color: ['#76d379'],
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            splitLine: {
                show: true,
                lineStyle: {
                    color: ['#046584']
                }
            },
            data: mesdate,
            axisLabel: {
                color: "#c0c0c0"
            },
            axisLine: {
                lineStyle: {
                    color: '#02f4ff'
                }
            }
        },
        yAxis: {
            type: 'value',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: true,
                lineStyle: {
                    color: ['#046584']
                }
            },
            axisLabel: {
                color: "#c0c0c0"
            },
            axisLine: {
                lineStyle: {
                    color: '#02f4ff'
                }
            }
        },
        series: [{
            name: '总数量',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            data: mesnum
        }]
    };
    msrefnum.setOption(option_message);

    $.ajax({
        url: "urltable/net",
        type: "POST",
        dataType: 'json',
        async: false,
        data: {},
        success: function (data) {
            netnum = data.netnum;
            netdate = data.netdate;
        }
    });
    option_net = {
        title: {
            text: '一周内上网数据恶意链接数量',
            x: 'center',
            textStyle:{
                color: '#FFF'
            }
        },
        color: ['#76d379'],
        tooltip: {
            trigger: 'axis',
        },
        xAxis: {
            type: 'category',
            splitLine: {
                show: true,
                lineStyle: {
                    color: ['#046584']
                }
            },
            data: netdate,
            axisLabel: {
                color: "#c0c0c0"
            },
            axisLine: {
                lineStyle: {
                    color: '#02f4ff'
                }
            }
        },
        yAxis: {
            type: 'value',
            boundaryGap: [0, '100%'],
            splitLine: {
                show: true,
                lineStyle: {
                    color: ['#046584']
                }
            },
            axisLabel: {
                color: "#c0c0c0"
            },
            axisLine: {
                lineStyle: {
                    color: '#02f4ff'
                }
            }
        },
        series: [{
            name: '总数量',
            type: 'line',
            showSymbol: false,
            hoverAnimation: false,
            data: netnum
        }]
    };
    netrefnum.setOption(option_net);
</script>
<!--传播源传播途径统计饼状图  -->
<script type="text/javascript">
    var mesnum;
    var netnum;
    var sourcebar = echarts.init(document.getElementById("sourcebar"));
    var waybar = echarts.init(document.getElementById("waybar"));
    $.ajax({
        url: "urltable/source",
        type: "POST",
        dataType: 'json',
        async: false,
        data: {},
        success: function (data) {
            mesnum = data.mesnum;
            netnum = data.netnum;
        }
    });
    option_source = {
        title: {
            text: '传播源占比统计',
            subtext: '传播源',
            x: 'center',
            textStyle:{
                color: '#FFF'
            }
        },
        color: ['#a1cfd3', '#76d379'],
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            x: '15%',
            y: '20%',
            data: ['短信数据', '上网日志'],
            textStyle:{
                color: '#c0c0c0'
            }
        },
        toolbox: {
            show: true,
            feature: {
                mark: {show: true},
                magicType: {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
            }
        },
        calculable: true,
        series: [
            {
                name: '数据源',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value: mesnum, name: '短信数据'},
                    {value: netnum, name: '上网日志'},
                ]
            }
        ]
    };
    sourcebar.setOption(option_source);

    option_way = {
        title: {
            text: '传播途径占比统计',
            subtext: '传播途径',
            x: 'center',
            textStyle:{
                color: '#FFF'
            }
        },
        color: ['#a1cfd3', '#76d379'],
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            x: '75%',
            y: '20%',
            data: ['短信数据', '上网日志'],
            textStyle:{
                color: '#c0c0c0'
            }
        },
        toolbox: {
            show: true,
            feature: {
                mark: {show: true},
                magicType: {
                    show: true,
                    type: ['pie', 'funnel'],
                    option: {
                        funnel: {
                            x: '25%',
                            width: '50%',
                            funnelAlign: 'left',
                            max: 1548
                        }
                    }
                },
            }
        },
        calculable: true,
        series: [
            {
                name: '传播途径',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value: netnum, name: '短信数据'},
                    {value: mesnum, name: '上网日志'},
                ]
            }
        ]
    };
    waybar.setOption(option_way);
</script>
</html>
